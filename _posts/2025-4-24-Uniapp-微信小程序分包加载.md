---
title: Uniappå¾®ä¿¡å°ç¨‹åºåˆ†åŒ…åŠ è½½
date: 2025-04-24 21:00:03 +0800
tags: å¾®ä¿¡å°ç¨‹åº
categories: æŠ€æœ¯æ¡†æ¶
---

## ä¸€ã€åˆ†åŒ…æœºåˆ¶æ¦‚è¿°
1. **èƒŒæ™¯è¯´æ˜**  
   - å¾®ä¿¡å°ç¨‹åºä¸»åŒ…é™åˆ¶2MBï¼Œæ€»åŒ…é™åˆ¶20MB  
2. **æ ¸å¿ƒä¼˜åŠ¿**  
   - çªç ´ä¸»åŒ…ä½“ç§¯é™åˆ¶  
   - å®ç°æŒ‰éœ€åŠ è½½  
   - æå‡é¦–å±åŠ è½½é€Ÿåº¦  
   - æ–¹ä¾¿å¤šå›¢é˜Ÿåä½œå¼€å‘  

## äºŒã€å®Œæ•´é…ç½®æµç¨‹
### 1. åŸºç¡€é…ç½®
```json
// manifest.json å¼€å¯åˆ†åŒ…
{
  "mp-weixin": {
    "optimization": {
      "subPackages": true
    }
  }
}
```

### 2. ç›®å½•ç»“æ„è§„èŒƒ
```
â”œâ”€â”€ pages                # ä¸»åŒ…é¡µé¢
â”‚   â””â”€â”€ tabBar
â”‚       â””â”€â”€ index.vue
â”œâ”€â”€ packageA             # åˆ†åŒ…A
â”‚   â”œâ”€â”€ components       # åˆ†åŒ…ç§æœ‰ç»„ä»¶
â”‚   â””â”€â”€ pages            # åˆ†åŒ…é¡µé¢
â”œâ”€â”€ packageB             # åˆ†åŒ…B
â”‚   â””â”€â”€ pages
â””â”€â”€ static               # å…¬å…±èµ„æº
```

3. pages.jsoné…ç½®
```json
{
  "pages": ["pages/tabBar/index"],
  "subPackages": [
    {
      "root": "packageA",
      "pages": ["pages/cat", "pages/dog"]
    },
    {
      "root": "packageB",
      "pages": [{
        "path": "pages/dog",
        "style": {
          "navigationBarTitleText": "å® ç‰©è¯¦æƒ…",
          "backgroundColor": "#F8F8F8"
        }
      }]
    }
  ],
  "preloadRule": {
    "pages/tabBar/index": {
      "network": "all",
      "packages": ["packageA"]
    }
  }
}
```

## ä¸‰ã€é¢„åŠ è½½æ·±åº¦ä¼˜åŒ–
### 1. é…ç½®å‚æ•°è¯´æ˜
| å‚æ•°å      | ç±»å‹       | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜                                                                 | å…¼å®¹æ€§       |
|-------------|------------|------|--------|--------------------------------------------------------------------|-------------|
| `network`   | String     | å¦   | all    | é¢„åŠ è½½ç½‘ç»œç¯å¢ƒï¼š<br>`all` - ä¸é™ç½‘ç»œ<br>`wifi` - ä»…WIFIç¯å¢ƒé¢„åŠ è½½       | å¾®ä¿¡åŸºç¡€åº“2.3.0+ |
| `packages`  | String[]   | ä¸`path`äºŒé€‰ä¸€ | æ—  | éœ€è¦é¢„åŠ è½½çš„åˆ†åŒ…åç§°æ•°ç»„ï¼ˆå¯¹åº”`subPackages`ä¸­çš„`root`å€¼ï¼‰              | å¾®ä¿¡åŸºç¡€åº“2.3.0+ |
| `path`      | String     | ä¸`packages`äºŒé€‰ä¸€ | æ—  | ç²¾ç¡®åˆ°é¡µé¢çš„é¢„åŠ è½½è·¯å¾„ï¼Œæ ¼å¼ï¼š`åˆ†åŒ…root/é¡µé¢è·¯å¾„`ï¼ˆå¦‚ï¼š`packageA/pages/cat`ï¼‰ | å¾®ä¿¡åŸºç¡€åº“2.11.1+ |

**è¡¨æ ¼ä½¿ç”¨è¯´æ˜ï¼š**
1. å½“`packages`å’Œ`path`åŒæ—¶å­˜åœ¨æ—¶ï¼Œ`path`ä¼˜å…ˆçº§æ›´é«˜
2. ç½‘ç»œç±»å‹æ£€æµ‹ä»¥å¾®ä¿¡å®¢æˆ·ç«¯åˆ¤æ–­ä¸ºå‡†

### 2. å®æˆ˜æŠ€å·§
é¦–å±åŠ é€Ÿï¼šåœ¨å¯åŠ¨é¡µé¢„åŠ è½½æ ¸å¿ƒåˆ†åŒ…

è¡Œä¸ºé¢„æµ‹ï¼šç”¨æˆ· hover æŒ‰é’®æ—¶é¢„åŠ è½½ç›®æ ‡é¡µ

ç½‘ç»œé€‚é…ï¼š

```json
"preloadRule": {
  "pages/home/index": {
    "network": "wifi",  // é‡è¦åˆ†åŒ…ä»…WIFIé¢„åŠ è½½
    "packages": ["paymentModule"]
  }
}
```

## å››ã€æ³¨æ„äº‹é¡¹ä¸æ’é”™
### 1. å®¹é‡çº¢çº¿
ğŸš¨ ä¸»åŒ…å¿…é¡»â‰¤2MB

ğŸš¨ å•ä¸ªåˆ†åŒ…â‰¤2MB

ğŸš¨ æ‰€æœ‰åˆ†åŒ…æ€»å’Œâ‰¤20MB

### 2. å¸¸è§é”™è¯¯
**è·¨åˆ†åŒ…å¼•ç”¨ç»„ä»¶**
è§£å†³ï¼šå°†ç»„ä»¶å£°æ˜ä¸ºå…¨å±€ç»„ä»¶æˆ–å¤åˆ¶åˆ°åˆ†åŒ…å†…

**é¢„åŠ è½½å¤±æ•ˆ**
è§£å†³ï¼šæ£€æŸ¥åˆ†åŒ…rootå‘½åæ˜¯å¦ä¸€è‡´


## äº”ã€é«˜çº§ä¼˜åŒ–æ–¹æ¡ˆ
### 1. èµ„æºä¼˜åŒ–
```javascript
// åŠ¨æ€åŠ è½½åˆ†åŒ…èµ„æº-ä»…æ”¯æŒå°æ¸¸æˆ
wx.loadSubPackage({
  root: 'packageA',
  success: () => {
    console.log('åˆ†åŒ…åŠ è½½å®Œæˆ')
  }
})
```

### 2. æ€§èƒ½ç›‘æ§
è¯¦ç»†å‚è€ƒ[æŒæ¡å°ç¨‹åºæ€§èƒ½ï¼Œåªè¦ä¸€ä¸ªAPI](https://developers.weixin.qq.com/community/business/doc/0002681b77cf901d42ad43f465100d)
```javascript
// è®°å½•åˆ†åŒ…åŠ è½½è€—æ—¶
wx.reportPerformance({
  id: '1001',
  value: Date.now() - startTime
})
```
